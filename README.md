# Stellar Flares Detection From Photometric Data Using Hidden Markov Models

This repo contains our work, shown in ---, on how to use a Gaussian Process and a hidden Markov model (HMM) to conduct flare detection. We call our model `celeriteQFD`. It simultaneously implements detrending and flare detection. We use `Celerite`, a Gaussian Process adopted from Python package [exoplanet-celerite2](https://github.com/exoplanet-dev/celerite2), for the former, and a three-state HMM for the latter. The R script [celeriteQFD](https://github.com/Esquivel-Arturo/celeriteQFD/blob/main/Res/CeleriteQFD/031381302/celeriteQFD.R) can be used to fit the model and produce most of the plots shown in the paper. As part of the analysis, Kepler flares were simulated using [simuFlare.R](https://github.com/Esquivel-Arturo/celeriteQFD/blob/main/R/simuFlares.R) and injected into the light curve of M dwarf TIC 031381302. Multiple injection and recovery experiments were performed using [flare_injection_CHTC.R](https://github.com/Esquivel-Arturo/celeriteQFD/blob/main/Res/Injection_recover/031381302/flare_injection_CHTC.R). An example of one experiment, including a comparison of our method with 1-3$\sigma$ is shown below:

![Alt text](https://github.com/Esquivel-Arturo/celeriteQFD/blob/main/Res/Injection_recover/flare_inj.png)

